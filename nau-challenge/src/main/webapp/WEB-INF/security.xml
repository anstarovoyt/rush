<beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:security="http://www.springframework.org/schema/security"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
          http://www.springframework.org/schema/security
          http://www.springframework.org/schema/security/spring-security-3.1.xsd">

    <security:http use-expressions="true" authentication-manager-ref="authManager" entry-point-ref="">
        <security:intercept-url pattern="/index.jsp" access="ROLE_ANONYMOUS" />
        <security:intercept-url pattern="/**" access="ROLE_USER" />
        <security:logout logout-url="/logout/" logout-success-url="/index" />
        <security:anonymous username="guest" granted-authority="ROLE_ANONYMOUS" />
        <security:remember-me />
    </security:http>
    
    <security:authentication-manager id="authManager">
        <security:authentication-provider ref="challengeAuthProvider">
        </security:authentication-provider>
    </security:authentication-manager>
    
    <bean id="challengeAuthProvider" class="ru.naumen.core.auth.ChallengeAuthProvider">
    </bean>

    <bean id="authenticationManager" class="org.springframework.security.authentication.ProviderManager">
        <property name="providers">
            <list>
                <ref local="challengeAuthProvider" />
            </list>
        </property>
    </bean>
</beans>   