package ru.naumen.core.game.impl;

import ru.naumen.core.game.Game;
import ru.naumen.core.game.GameState;

/**
 * @author Andrey Hitrin
 * @since 01.11.13
 */
public class TrollLife implements Game
{
    public static final String ID = "life";
    public static final String DESCRIPTION = "<p>Космический биолог Зак разводит в лаборатории примитивные формы жизни. " +
        "Эти формы умеют размножаться в точности по законам игры <a href=\"http://ru.wikipedia.org/wiki/%D0%96%D0%B8%D0%B7%D0%BD%D1%8C_(%D0%B8%D0%B3%D1%80%D0%B0)\">\"Жизнь\"</a>.</p>" +
        "<p>Придя в лабораторию как-то утром Зак обнаружил, что клетки образовали странный рисунок." +
        "Но это его не смутило, и он провёл эксперимент до конца. Проведите его и Вы!</p>" +
        "<img src=\"/resources/img/trollface.png\"/>" +
        "<p>Укажите (в виде таблицы из нолей и единиц), во что превратится этот набор клеток спустя ровно 100 поколений.</p>";

    private static final String EXPECTED_STATE =
        "000000000000000000000000000000000000000000000000000000110000000000000000" +
        "000000000000000000000000000000000000000000000000000000110000000000000000" +
        "000000000000000000000000000000000000000000000000000000000000000000000000" +
        "000000000000000000000000000000000000000000000000000000000000000000000000" +
        "000000000000000000000000000000000000000000000000000110000000000000000000" +
        "000000000000000000000000000000000000000000000000001001000000000000000000" +
        "000000000000000000000000000000000000000000000000001010000000000000000000" +
        "000000000000000000000000000000000000000000000000000100000000000000000000" +
        "000000000000000000000000000000000000000000000000000000000000000000000000" +
        "000000000000000000000000000000000000000000000000000000000000000000000000" +
        "000000000000000000000011000000000000000000000000000000000000000000000000" +
        "000000000000000000000101000000000000000000000000000000000000000000000000" +
        "000111000000000000000001000000000000000000000000000000000000000000000000" +
        "001001000000000000000000000000000001010000000000000000000000000000000000" +
        "001000100000000000000000000000000001000000000000000000000000000000010000" +
        "011001000000000000000000000000000000000100000110000000000000000000101000" +
        "000100000000000000000000000000000000011010000110000000000000000000011000" +
        "000011000000000000000000000000000000000011000000000000000000000000000000" +
        "000011100000000000000000000000000000000000000000000000000000000000000000" +
        "000111100000000000000000000000000000000000000001000000000000000000000000" +
        "000000000000000000000000000000000010000000000001100000000000000000000000" +
        "000000000000000000000000000000000010010000000001110000000000000000000000" +
        "000101000000000000000000000000000110011100000001100000000000000000000000" +
        "001101100000000000000000000000000111000000000001000000000000000000000000" +
        "010101100000011000000000000000011100001100000000000000000000000000000000" +
        "110111100000011000000000000000001111111000000000000000000000000000000000" +
        "001111100000000000000000000000000100100000000000000000000000000000000000" +
        "011001000000000000000000000000001000000001100000000000000000000000000000" +
        "001110000000000000000000000000001000000001100000000000000000000000000000" +
        "000100000000000000000000000000000010000000000000000000000000000000000010" +
        "000000000000000000000000000000000000000000000000000000000000000000000101" +
        "000000000000000000000000000000000000000000000000000110000000000000000101" +
        "000000000000000000000000000000000000000000000000000110000000000000000010" +
        "000000000000000000000000000000000000000000000000000000000000000000000000" +
        "000000000000000000000000000000000000000000000000000000000000000000000000" +
        "000000000000000000000000000000000000000000000000000000111000000000000000" +
        "000000000000000000000000000000000000000000000000000000000001110000000000";

    private GameState currentState = GameState.IN_PROGRESS;

    @Override
    public String getShortName()
    {
        return "Game of Life";
    }

    @Override
    public String getShortDescription()
    {
        return "Игра \"Жизнь\"";
    }

    @Override
    public String getStateRepresentation()
    {
        return null;
    }

    @Override
    public String getDescription()
    {
        return DESCRIPTION;
    }

    @Override
    public String getId()
    {
        return ID;
    }

    @Override
    public void input(String userInput)
    {
        currentState = isValid(userInput) ? GameState.VICTORY : GameState.FAILURE;
    }

    private boolean isValid(String userInput)
    {
        return EXPECTED_STATE.equals(userInput.replaceAll(" ", "").replaceAll("\n", "").replaceAll("\r", ""));
    }

    @Override
    public String output()
    {
        return null;
    }

    @Override
    public GameState state()
    {
        return currentState;
    }

    @Override
    public Game resetState()
    {
        return this;
    }
}
